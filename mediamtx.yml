# mediamtx.yml - HLS-Optimized for Railway
logLevel: info
logDestinations: [stdout]
readTimeout: 10s
writeTimeout: 10s

# API
api: yes
apiAddress: :9997
apiAllowOrigin: '*'

# ✅ CRITICAL: HLS Configuration for Railway
hls: yes
hlsAddress: :8888
hlsAllowOrigin: '*'
hlsAlwaysRemux: yes
hlsVariant: mpegts
hlsSegmentCount: 7
hlsSegmentDuration: 2s
hlsPartDuration: 500ms
hlsSegmentMaxSize: 50M
hlsDirectory: ''
hlsMuxerCloseAfter: 60s

# ✅ WebRTC - Simplified for Railway
webrtc: yes
webrtcAddress: :8889
webrtcAllowOrigin: '*'
webrtcLocalUDPAddress: :8189
webrtcLocalTCPAddress: ''
webrtcIPsFromInterfaces: no
webrtcAdditionalHosts: ["0.0.0.0"]
webrtcICEServers2:
  - url: stun:stun.l.google.com:19302
webrtcHandshakeTimeout: 10s
webrtcTrackGatherTimeout: 2s

# RTSP
rtsp: yes
rtspAddress: :8554
rtspTransports: [tcp]

# ✅ CRITICAL: Path settings for HLS conversion
pathDefaults:
  source: publisher
  sourceOnDemand: no
  maxReaders: 0
  record: no
  runOnReady: ''
  runOnNotReady: ''
  overridePublisher: yes

paths:
  all_others:
    source: publisher
